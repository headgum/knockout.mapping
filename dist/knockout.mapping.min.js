!function(e){"use strict";if("function"==typeof require&&"object"==typeof exports&&"object"==typeof module)e(require("tko"),exports);else if("function"==typeof define&&define.amd)define(["tko","exports"],e);else{if("undefined"==typeof ko)throw new Error("Knockout is required, please ensure it is loaded before loading this mapping plug-in");e(ko,ko.mapping={})}}(function(S,A){"use strict";S.mapping=A;var N,M,u=!1,C="__ko_mapping__",s=S.dependentObservable,i=0,o=["create","update","key","arrayChanged"],q={},e={include:["_destroy"],ignore:[],copy:[],observe:[]},p=e;function a(e,r){var t,n;for(t in r)r.hasOwnProperty(t)&&r[t]&&(n=A.getType(e[t]),t&&e[t]&&"array"!==n&&"string"!==n?a(e[t],r[t]):(n="array"===A.getType(e[t])&&"array"===A.getType(r[t]),e[t]=n?function(){for(var e,r,t,n=arguments,a=n.length,i={},o=[];a--;)for(e=(t=n[a]).length;e--;)i[r=t[e]]||(i[r]=1,o.push(r));return o}(e[t],r[t]):r[t]))}function F(e,r){var t={};return a(t,e),a(t,r),t}function v(e,r){for(var t=F({},e),n=o.length-1;0<=n;n--){var a=o[n];t[a]&&(t[""]instanceof Object||(t[""]={}),t[""][a]=t[a],delete t[a])}return r&&(t.ignore=l(r.ignore,t.ignore),t.include=l(r.include,t.include),t.copy=l(r.copy,t.copy),t.observe=l(r.observe,t.observe)),t.ignore=l(t.ignore,p.ignore),t.include=l(t.include,p.include),t.copy=l(t.copy,p.copy),t.observe=l(t.observe,p.observe),t.mappedProperties=t.mappedProperties||{},t.copiedProperties=t.copiedProperties||{},t}function l(e,r){return void 0===e?e=[]:"array"!==A.getType(e)&&(e=[e]),void 0===r?r=[]:"array"!==A.getType(r)&&(r=[r]),S.utils.arrayGetDistinctValues(e.concat(r))}function R(o,e){var r=S.dependentObservable;S.dependentObservable=function(e,r,t){t=e&&"object"==typeof e?e:t||{};var n=t.deferEvaluation,a=t.pure,i=!1;t.deferEvaluation=!0;t=s(e,r,t);return n||a||(t=function(r){var e=S.dependentObservable;S.dependentObservable=s;var t=S.isWriteableObservable(r);S.dependentObservable=e;t=s({read:function(){return i||(S.utils.arrayRemoveItem(o,r),i=!0),r.apply(r,arguments)},write:t&&function(e){return r(e)},deferEvaluation:!0});return u&&(t._wrapper=!0),t.__DO=r,t}(t),o.push(t)),t},S.dependentObservable.fn=s.fn,S.computed=S.dependentObservable;e=e();return S.dependentObservable=r,S.computed=S.dependentObservable,e}function $(e,r,t){for(var n=0,a=e.length;n<a;n++)if(!0!==t[n]&&e[n]===r)return n;return null}function f(e,r){var t;return r&&(t=r(e)),"undefined"===A.getType(t)&&(t=e),S.utils.unwrapObservable(t)}function G(e,r,t){for(var n=0,a=(e=S.utils.unwrapObservable(e)).length;n<a;n++){var i=e[n];if(f(i,t)===r)return i}throw new Error("When calling ko.update*, the key '"+r+"' was not found!")}function K(e,r){return S.utils.arrayMap(S.utils.unwrapObservable(e),function(e){return r?f(e,r):e})}function V(e,r){if("array"===A.getType(e))for(var t=0;t<e.length;t++)r(t);else for(var n in e)e.hasOwnProperty(n)&&r(n)}function z(e){if(null!==e){e=A.getType(e);return"object"===e||"array"===e}}function B(e){return(""+e).replace(/~/g,"~~").replace(/\[/g,"~[").replace(/]/g,"~]").replace(/\./g,"~.")}function c(){var n=[],a=[];this.save=function(e,r){var t=S.utils.arrayIndexOf(n,e);0<=t?a[t]=r:(n.push(e),a.push(r))},this.get=function(e){e=S.utils.arrayIndexOf(n,e);return 0<=e?a[e]:void 0}}function d(){function t(e){var r;try{r=e}catch(e){r="$$$"}var t=n[r];return n.hasOwnProperty(r)||(t=new c,n[r]=t),t}var n={};this.save=function(e,r){t(e).save(e,r)},this.get=function(e){return t(e).get(e)}}A.isMapped=function(e){e=S.utils.unwrapObservable(e);return e&&e[C]},A.fromJS=function(e){if(0===arguments.length)throw new Error("When calling ko.fromJS, pass the object you want to convert.");try{var r,t;i||(N=[],M=new d),i++,2===arguments.length&&(arguments[1][C]?t=arguments[1]:r=arguments[1]),3===arguments.length&&(r=arguments[1],t=arguments[2]),t&&(r=F(r,t[C]));var n=function a(i,o,u,t,r,s,e){var n="array"===A.getType(S.utils.unwrapObservable(o));s=s||"";{var p;A.isMapped(i)&&(p=S.utils.unwrapObservable(i)[C],u=F(p,u))}var l={data:o,parent:e||r};var f=function(){return u[t]&&u[t].create instanceof Function};var c=function(e){return R(N,function(){return S.utils.unwrapObservable(r)instanceof Array?u[t].create({data:e||l.data,parent:l.parent,skip:q}):u[t].create({data:e||l.data,parent:l.parent})})};var v=function(){return u[t]&&u[t].update instanceof Function};var d=function(e,r){var r={data:r||l.data,parent:l.parent,target:S.utils.unwrapObservable(e)};return S.isWriteableObservable(e)&&(r.observable=e),u[t].update(r)};e=M.get(o);if(e)return e;t=t||"";if(n){var b=[],e=!1,y=function(e){return e};u[t]&&u[t].key&&(y=u[t].key,e=!0),S.isObservable(i)||((i=S.observableArray([])).mappedRemove=function(r){var t="function"==typeof r?r:function(e){return e===y(r)};return i.remove(function(e){return t(y(e))})},i.mappedRemoveAll=function(e){var r=K(e,y);return i.remove(function(e){return-1!==S.utils.arrayIndexOf(r,y(e))})},i.mappedDestroy=function(r){var t="function"==typeof r?r:function(e){return e===y(r)};return i.destroy(function(e){return t(y(e))})},i.mappedDestroyAll=function(e){var r=K(e,y);return i.destroy(function(e){return-1!==S.utils.arrayIndexOf(r,y(e))})},i.mappedIndexOf=function(e){var r=K(i(),y),e=y(e);return S.utils.arrayIndexOf(r,e)},i.mappedGet=function(e){return i()[i.mappedIndexOf(e)]},i.mappedCreate=function(e){if(-1!==i.mappedIndexOf(e))throw new Error("There already is an object with the key that you specified.");var r=f()?c(e):e;return v()&&(e=d(r,e),S.isWriteableObservable(r)?r(e):r=e),i.push(r),r});var n=K(S.utils.unwrapObservable(i),y).sort(),g=K(o,y);e&&g.sort();var O,h,w,m=S.utils.compareArrays(n,g),k={},T=S.utils.unwrapObservable(o),x={},j=!0;for(O=0,h=T.length;O<h;O++){if(void 0===(w=y(T[O]))||w instanceof Object){j=!1;break}x[w]=T[O]}var I,E,P,_=[],J=0;for(O=0,h=m.length;O<h;O++){w=m[O];var W=s+"["+B(O)+"]";switch(w.status){case"added":I=j?x[w.value]:G(S.utils.unwrapObservable(o),w.value,y),P=a(void 0,I,u,t,i,W,r),f()||(P=S.utils.unwrapObservable(P)),E=$(S.utils.unwrapObservable(o),I,k),P===q?J++:_[E-J]=P,k[E]=!0;break;case"retained":I=j?x[w.value]:G(S.utils.unwrapObservable(o),w.value,y),P=G(i,w.value,y),a(P,I,u,t,i,W,r),E=$(S.utils.unwrapObservable(o),I,k),_[E]=P,k[E]=!0;break;case"deleted":P=G(i,w.value,y)}b.push({event:w.status,item:P})}i(_),u[t]&&u[t].arrayChanged&&S.utils.arrayForEach(b,function(e){u[t].arrayChanged(e.event,e.item)})}else if(z(o)){if(!(i=S.utils.unwrapObservable(i))){if(f()){var g=c();return v()&&(g=d(g)),g}if(v())return d();i={}}if(v()&&(i=d(i)),M.save(o,i),v())return i;V(o,function(e){var r=s.length?s+"."+B(e):B(e);if(-1===S.utils.arrayIndexOf(u.ignore,r))if(-1===S.utils.arrayIndexOf(u.copy,r)){if("object"!=typeof o[e]&&"array"!==A.getType(o[e])&&0<u.observe.length&&-1===S.utils.arrayIndexOf(u.observe,r))return i[e]=o[e],void(u.copiedProperties[r]=!0);var t=M.get(o[e]),n=a(i[e],o[e],u,e,i,r,i),n=t||n;if(0<u.observe.length&&-1===S.utils.arrayIndexOf(u.observe,r))return i[e]=S.utils.unwrapObservable(n),void(u.copiedProperties[r]=!0);S.isWriteableObservable(i[e])?(n=S.utils.unwrapObservable(n),i[e]()!==n&&i[e](n)):(n=void 0===i[e]?n:S.utils.unwrapObservable(n),i[e]=n),u.mappedProperties[r]=!0}else i[e]=o[e]})}else if("function"===A.getType(o))i=v()?S.isWriteableObservable(o)?(o(d(o)),o):d(o):o;else{if(S.isWriteableObservable(i))return D=v()?d(i):S.utils.unwrapObservable(o),i(D),D;var D=f()||v();if(i=f()?c():S.observable(S.utils.unwrapObservable(o)),v()&&i(d(i)),D)return i}return i}(t,e,r=v(r));if(t&&(n=t),!--i)for(;N.length;){var a=N.pop();a&&(a(),a.__DO.throttleEvaluation=a.throttleEvaluation)}return n[C]=F(n[C],r),n}catch(e){throw i=0,e}},A.fromJSON=function(e){var r=Array.prototype.slice.call(arguments,0);return r[0]=S.utils.parseJson(e),A.fromJS.apply(this,r)},A.toJS=function(e,r){if(p||A.resetDefaultOptions(),0===arguments.length)throw new Error("When calling ko.mapping.toJS, pass the object you want to convert.");if("array"!==A.getType(p.ignore))throw new Error("ko.mapping.defaultOptions().ignore should be an array.");if("array"!==A.getType(p.include))throw new Error("ko.mapping.defaultOptions().include should be an array.");if("array"!==A.getType(p.copy))throw new Error("ko.mapping.defaultOptions().copy should be an array.");return r=v(r,e[C]),A.visitModel(e,function(e){return S.utils.unwrapObservable(e)},r)},A.toJSON=function(e,r,t,n){r=A.toJS(e,r);return S.utils.stringifyJson(r,t,n)},A.defaultOptions=function(){if(!(0<arguments.length))return p;p=arguments[0]},A.resetDefaultOptions=function(){p={include:e.include.slice(0),ignore:e.ignore.slice(0),copy:e.copy.slice(0),observe:e.observe.slice(0)}},A.getType=function(e){if(e&&"object"==typeof e){if(e.constructor===Date)return"date";if(e.constructor===Array)return"array"}return typeof e},A.visitModel=function(e,s,p){var l;(p=p||{}).visitedObjects=p.visitedObjects||new d;var f=S.utils.unwrapObservable(e);if(!z(f))return s(e,p.parentName);p=v(p,f[C]),s(e,p.parentName),l="array"===A.getType(f)?[]:{},p.visitedObjects.save(e,l);var c=p.parentName;return V(f,function(e){var r=B(e);if(!p.ignore||-1===S.utils.arrayIndexOf(p.ignore,r)){var t,n,a=f[e];if(p.parentName=(t=c,n=f,i=e,o=t||"","array"===A.getType(n)?t&&(o+="["+B(i)+"]"):(t&&(o+="."),o+=B(i)),o),-1===S.utils.arrayIndexOf(p.copy,r)&&-1===S.utils.arrayIndexOf(p.include,r)){var i=f[C];if(i){var o=i.mappedProperties;if(o&&!o[r]){i=i.copiedProperties;if(i&&!i[r]&&"array"!==A.getType(f))return}}}switch(A.getType(S.utils.unwrapObservable(a))){case"object":case"array":case"undefined":var u=p.visitedObjects.get(a);l[e]="undefined"!==A.getType(u)?u:A.visitModel(a,s,p);break;default:l[e]=s(a,p.parentName)}}}),l}});
//# sourceMappingURL=knockout.mapping.min.js.map
